{"ast":null,"code":"import{Button,DialogContent,TextField,Grid}from'@mui/material';import{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{BrowserRouter as Router,Routes,Route,Link,Redirect,Switch}from\"react-router-dom\";import{getCsrfToken}from\"./CSRFToken\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function UpdateBookPage(props){const{isbn}=useParams();const[title,setTitle]=useState(\"\");const[author,setAuthor]=useState(\"\");const[publisher,setPublisher]=useState(\"\");const[pubdate,setPubdate]=useState(\"\");const[cover,setCover]=useState(\"\");const[douban_url,setDouban]=useState(\"\");const[buy_kong,setKong]=useState(\"\");const[buy_dang,setDang]=useState(\"\");/*\r\n    let res= fetch(\"/api/get-book\"+\"?isbn=\"+isbn)\r\n    let data=res.json()*/const navigate=useNavigate();const csrftoken=getCsrfToken();useEffect(()=>{console.log(isbn);fetch(\"/api/get-book\"+\"?isbn=\"+isbn).then(res=>{return res.json();}).then(data=>{setTitle(data.title);setAuthor(data.author);setPubdate(data.pubdate);setPublisher(data.publisher);setCover(data.cover);setDouban(data.douban_url);setKong(\"https://search.kongfz.com/product/?keyword=\"+isbn+\"&dataType=0\");setDang(\"http://search.dangdang.com/?key=\"+isbn+\"&act=input\");});},[]);async function handleSubmit(){console.log(\"handling submit\");const requestOption={method:\"PATCH\",headers:{\"Content-Type\":\"application/json\",\"X-CSRFToken\":csrftoken},body:JSON.stringify({book:{isbn:isbn,title:title,author:author,publisher:publisher,pubdate:pubdate,cover:cover,douban_url:douban_url}})};let response=await fetch(\"/api/update-book\",requestOption);let data=await response.json();navigate('/book/'+isbn);}return/*#__PURE__*/_jsx(\"div\",{className:\"updateBookPage\",children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,align:\"center\",justifyContent:\"center\",children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,item:true,xs:6,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"This is update Book\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:isbn,label:\"ISBN\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:title,label:\"书名\",onChange:e=>{setTitle(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:author,label:\"作者\",onChange:e=>{setAuthor(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:publisher,label:\"出版社\",onChange:e=>{setPublisher(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:pubdate,label:\"出版日期\",onChange:e=>{setPubdate(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:cover,label:\"封面\",onChange:e=>{setCover(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(TextField,{value:douban_url,label:\"豆瓣链接\",onChange:e=>{setDouban(e.target.value);}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,align:\"center\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSubmit,children:\"\\u4FEE\\u6539\"})}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:12,align:\"center\",children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",to:buy_kong,component:Link,children:\"\\u5B54\\u592B\\u5B50\\u65E7\\u4E66\\u7F51\\u8D2D\\u4E70\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",to:buy_dang,component:Link,children:\"\\u5F53\\u5F53\\u7F51\\u8D2D\\u4E70\"})]})]})})});}export default UpdateBookPage;","map":{"version":3,"names":["Button","DialogContent","TextField","Grid","useState","useEffect","useParams","useNavigate","BrowserRouter","Router","Routes","Route","Link","Redirect","Switch","getCsrfToken","jsx","_jsx","jsxs","_jsxs","UpdateBookPage","props","isbn","title","setTitle","author","setAuthor","publisher","setPublisher","pubdate","setPubdate","cover","setCover","douban_url","setDouban","buy_kong","setKong","buy_dang","setDang","navigate","csrftoken","console","log","fetch","then","res","json","data","handleSubmit","requestOption","method","headers","body","JSON","stringify","book","response","className","children","container","spacing","align","justifyContent","item","xs","value","label","onChange","e","target","variant","onClick","to","component"],"sources":["D:/projects/SE-project/textbook_genius/frontend/reactapp/src/components/UpdateBookPage.js"],"sourcesContent":["import {Button,DialogContent,TextField,Grid} from '@mui/material';\r\nimport { useState,useEffect } from 'react';\r\nimport {useParams, useNavigate} from 'react-router-dom';\r\nimport {\r\n    BrowserRouter as Router,\r\n    Routes,\r\n    Route,\r\n    Link,\r\n    Redirect,\r\n    Switch\r\n} from \"react-router-dom\";\r\nimport {getCsrfToken} from \"./CSRFToken\";\r\n\r\nfunction UpdateBookPage(props){\r\n    const { isbn } = useParams();\r\n    const[title,setTitle]=useState(\"\");\r\n    const[author,setAuthor]=useState(\"\");\r\n    const[publisher,setPublisher]=useState(\"\");\r\n    const[pubdate,setPubdate]=useState(\"\");\r\n    const[cover,setCover]=useState(\"\");\r\n    const[douban_url,setDouban]=useState(\"\");\r\n\r\n    const[buy_kong,setKong]=useState(\"\")\r\n    const[buy_dang,setDang]=useState(\"\")\r\n      \r\n    /*\r\n    let res= fetch(\"/api/get-book\"+\"?isbn=\"+isbn)\r\n    let data=res.json()*/\r\n\r\n    const navigate=useNavigate();\r\n    const csrftoken=getCsrfToken();\r\n\r\n    useEffect(() => {\r\n        console.log(isbn);\r\n        fetch(\"/api/get-book\"+\"?isbn=\"+isbn)\r\n        .then(res=>{\r\n            return res.json()\r\n        })\r\n        .then(data=>{\r\n            setTitle(data.title);\r\n            setAuthor(data.author);\r\n            setPubdate(data.pubdate);\r\n            setPublisher(data.publisher);\r\n            setCover(data.cover);\r\n            setDouban(data.douban_url);\r\n\r\n            setKong(\"https://search.kongfz.com/product/?keyword=\"+isbn+\"&dataType=0\")\r\n            setDang(\"http://search.dangdang.com/?key=\"+isbn+\"&act=input\")\r\n        })\r\n    }, []);   \r\n\r\n    async function handleSubmit(){\r\n        console.log(\"handling submit\")\r\n        const requestOption={\r\n            method:\"PATCH\",\r\n            headers:{\r\n                \"Content-Type\": \"application/json\",\r\n                \"X-CSRFToken\": csrftoken\r\n            },\r\n            body:JSON.stringify({\r\n                book:{\r\n                    isbn:isbn,\r\n                    title:title,\r\n                    author:author,\r\n                    publisher:publisher,\r\n                    pubdate:pubdate,\r\n                    cover:cover,\r\n                    douban_url:douban_url\r\n                },\r\n            }),\r\n        };\r\n        let response=await fetch(\"/api/update-book\",requestOption)\r\n        let data=await response.json();\r\n        navigate('/book/'+isbn);\r\n    }\r\n\r\n    return(\r\n        <div className='updateBookPage'>\r\n            <Grid container spacing={3} align=\"center\" justifyContent=\"center\">\r\n                <Grid container spacing={2} item xs={6}>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <h1>This is update Book</h1>\r\n                    </Grid>  \r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={isbn} label={\"ISBN\"}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={title} label={\"书名\"} onChange={(e)=>{setTitle(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={author} label={\"作者\"} onChange={(e)=>{setAuthor(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={publisher} label={\"出版社\"} onChange={(e)=>{setPublisher(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={pubdate} label={\"出版日期\"} onChange={(e)=>{setPubdate(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={cover} label={\"封面\"} onChange={(e)=>{setCover(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <TextField value={douban_url} label={\"豆瓣链接\"} onChange={(e)=>{setDouban(e.target.value)}}/>    \r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <Button variant=\"contained\" onClick={handleSubmit}>修改</Button>\r\n                    </Grid>\r\n                    <Grid item xs={12} align=\"center\">\r\n                        <Button variant=\"contained\" to={buy_kong} component={Link}>孔夫子旧书网购买</Button>\r\n                        <Button variant=\"contained\" to={buy_dang} component={Link}>当当网购买</Button>\r\n                    </Grid>\r\n                </Grid>\r\n            </Grid>\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default UpdateBookPage"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}